<launch>

	<include file="$(find cnbiros_robotino)/launch/robotino_stack.launch">
		<arg name="hostname" value="192.168.1.3" />
	</include>

	<!-- Interface C -->
	<node pkg="cnbiros_bci" type="tobi_interface_c" name="tobi_interface_c" output="screen" >
		<rosparam param="cnbiloop">127.0.0.1:8123</rosparam>
		<rosparam param="frompipes">[/ctrl10]</rosparam>
	</node>	

		<arg name="camera" default="camera" />

    	<!-- Kinectscan -->
    	<include file="$(find openni_launch)/launch/openni.launch">
    	    <arg name="camera" default="$(arg camera)"/>
    	</include>

    	<!-- run pointcloud_to_laserscan node -->
    	<node pkg="pointcloud_to_laserscan" type="pointcloud_to_laserscan_node" name="pointcloud_to_laserscan">

    	    <remap from="cloud_in" to="$(arg camera)/depth_registered/points"/>
    	    <remap from="scan" to="$(arg camera)/scan"/>
    	    <rosparam>
               target_frame: camera_link # Leave disabled to output scan in pointcloud frame
               transform_tolerance: 0.01
               min_height: 0.0
               max_height: 1.0
               
               angle_min: -1.5708 # -M_PI/2
               angle_max: 1.5708 # M_PI/2
               angle_increment: 0.01 #0.087 # M_PI/360.0
               scan_time: 0.3333
               range_min: 0.45
               range_max: 4.0
               use_inf: true
               
               # Concurrency level, affects number of pointclouds queued for processing and number of threads used
               # 0 : Detect number of cores
               # 1 : Single threaded
               # 2->inf : Parallelism level
               concurrency_level: 1
            </rosparam>

    	</node>
	
	<!-- Forcefield group -->
	<group ns="forcefield">
		<node name="forcefield_node_repellors" pkg="cnbiros_forcefield" type="forcefield_node_repellors" output="screen" />
		<node name="forcefield_node_attractors" pkg="cnbiros_forcefield" type="forcefield_node_attractors" output="screen" />
	</group>

	<!-- Launch rviz -->
	<node name="rviz" pkg="rviz" type="rviz" args="-d $(find cnbiros_robotino)/rviz/grid_map.rviz" />

</launch>
